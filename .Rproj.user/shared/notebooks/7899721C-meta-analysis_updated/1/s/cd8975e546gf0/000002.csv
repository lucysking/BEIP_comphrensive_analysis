"0","itsea_ages <-"
"0","  d0 %>% "
"0","  select("
"0","    ID,"
"0","    bl_age_end,"
"0","    starts_with(""ageitsea"")"
"0","  ) %>% "
"0","  gather(itsea_key, age, ageitsea..00:ageitsea.5.00) %>% "
"0","  mutate("
"0","    itsea_key = recode("
"0","      itsea_key,"
"0","      ""ageitsea..00"" = ""0"","
"0","      ""ageitsea.1.00"" = ""1"","
"0","      ""ageitsea.2.00"" = ""2"","
"0","      ""ageitsea.3.00"" = ""3"","
"0","      ""ageitsea.4.00"" = ""4"","
"0","      ""ageitsea.5.00"" = ""5"""
"0","    )"
"0","  ) %>% "
"0","  mutate("
"0","    age_diff_BL = abs(age - bl_age_end),"
"0","    age_diff_30 = abs(age - 30),"
"0","    age_diff_42 = abs(age - 42),"
"0","    age_diff_54 = abs(age - 54)"
"0","  ) %>% "
"0","  group_by(ID) %>% "
"0","  mutate("
"0","    min_age_diff = pmin("
"0","      age_diff_BL, "
"0","      age_diff_30, "
"0","      age_diff_42, "
"0","      age_diff_54"
"0","    ),"
"0","    wave = case_when("
"0","      min_age_diff == age_diff_BL ~ ""0"","
"0","      min_age_diff == age_diff_30 ~ ""30"","
"0","      min_age_diff == age_diff_42 ~ ""42"","
"0","      min_age_diff == age_diff_54 ~ ""54"""
"0","    ),"
"0","    wave = if_else("
"0","      itsea_key == ""0"", ""0"", wave"
"0","    )"
"0","  ) %>% "
"0","  filter(!is.na(age)) %>% "
"0","  arrange(ID, wave, age) %>% "
"0","  group_by(ID) %>% "
"0","  mutate("
"0","    wave = case_when("
"0","      lag(wave) == ""0"" & wave == ""0"" ~ ""30"","
"0","      is.na(wave) & itsea_key == ""0"" ~ ""0"","
"0","      lead(wave) == ""42"" & wave == ""42"" & age < lead(age) ~ ""drop"","
"0","      TRUE ~ wave"
"0","    ),"
"0","    wave = case_when("
"0","      lead(wave) == ""30"" & wave == ""30"" & age < lead(age) ~ ""drop"","
"0","      wave == ""0"" ~ ""BL"","
"0","      TRUE ~ wave"
"0","    ),"
"0","    wave = if_else("
"0","      wave == ""30"" & age < 20,"
"0","      ""drop"", wave"
"0","    )"
"0","  ) %>% "
"0","  ungroup() %>% "
"0","  filter(wave != ""drop"", !is.na(wave)) %>% "
"0","  select(-c(age_diff_BL:min_age_diff))"
"2","attributes are not identical across measure variables;
they will be dropped"
