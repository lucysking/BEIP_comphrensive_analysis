"0","# create person-mean-centered variable for tanner stage and average across t1 and t2 for other time-varying covariates"
"0","cd_wf_clean <-"
"0","  cd_wf_clean %>% "
"0","  mutate("
"0","    tan_diff = if_else("
"0","      !is.na(tanner_t2) & !is.na(tanner_t1),"
"0","      tanner_t2 - tanner_t1, NA_real_"
"0","    ),"
"0","    dhea_diff = if_else("
"0","      !is.na(dhea_clean_t2) & !is.na(dhea_clean_t1),"
"0","      dhea_clean_t2 - dhea_clean_t1, NA_real_"
"0","    ),"
"0","    test_diff = if_else("
"0","      !is.na(test_clean_t2) & !is.na(test_clean_t1),"
"0","      test_clean_t2 - test_clean_t1, NA_real_"
"0","    )"
"0","  )"
"0","cd_clean <- "
"0","  cd_clean %>% "
"0","  left_join("
"0","    cd_wf_clean %>% "
"0","      filter("
"0","        # prevents from merging a difference score for those with hormones at only 1 timepoint (do not want to model their change)"
"0","        !is.na(cort_clean_t2) | !is.na(dhea_clean_t2) | !is.na(test_clean_t2),"
"0","        !is.na(cort_clean_t1) | !is.na(dhea_clean_t1) | !is.na(test_clean_t1)"
"0","      ) %>% "
"0","      select(ELS_ID, tan_diff, dhea_diff, test_diff), "
"0","    by = ""ELS_ID"""
"0","  ) %>% "
"0","  group_by(ELS_ID) %>% "
"0","  mutate("
"0","     time = case_when("
"0","      !is.na(interval_yr) & timepoint == ""T1"" ~ 0,"
"0","      !is.na(interval_yr) & timepoint == ""T2"" ~ interval_yr,"
"0","      TRUE ~ NA_real_"
"0","    ), "
"0","    time_per_cent = if_else("
"0","      !is.na(interval_yr),"
"0","      time - mean(time), NA_real_"
"0","    ),"
"0","    dhea_per_cent = if_else("
"0","      !is.na(dhea_diff),"
"0","      dhea_clean - mean(dhea_clean), NA_real_"
"0","    ),"
"0","    test_per_cent = if_else("
"0","      !is.na(test_diff),"
"0","      test_clean - mean(test_clean), NA_real_"
"0","    ),"
"0","    tan_per_cent = if_else("
"0","      !is.na(tan_diff),"
"0","      tanner_av - mean(tanner_av), NA_real_"
"0","    ),"
"0","    tan_diff_lg = case_when("
"0","      timepoint == ""T1"" & !is.na(tan_diff) ~ 0,"
"0","      timepoint == ""T2"" ~ tan_diff,"
"0","      TRUE ~ NA_real_     "
"0","    ),"
"0","    age_av_t1t2 = mean(child_age, na.rm = TRUE),"
"0","    dhea_av_t1t2 = mean(dhea_clean, na.rm = TRUE),"
"0","    test_av_t1t2 = mean(test_clean, na.rm = TRUE),"
"0","    tanner_av_t1t2 = mean(tanner_av, na.rm = TRUE),"
"0","    timecoll_av_t1t2 = mean(time_collection, na.rm = TRUE),"
"0","    bmi_av_t1t2 = mean(bmi, na.rm = TRUE),"
"0","    age_av_t1t2 = mean(child_age, na.rm = TRUE)"
"0","  ) %>% "
"0","  ungroup() "
